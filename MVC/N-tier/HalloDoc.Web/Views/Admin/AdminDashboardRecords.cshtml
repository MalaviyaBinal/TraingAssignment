@model HalloDocWebEntity.ViewModel.AdminRecordsModel
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor Accessor
@{
    ViewData["Title"] = "Search Records";
    Layout = "_AdminHeader";
    ViewBag.tab = "records";
}

<div class="m-3 ">

    <div class=" row  mb-4 ">
        <div class="col-sm-10 col">
            <span class="h2">Search Records</span>
        </div>
        <div class="col-sm-2 text-end col">

            <a asp-action="ExportRecords">
                <button class="btn btn-info  text-white">
                <i class="fa-solid fa-share-from-square" style="color: #ffffff;"></i> Export Data To Excel
                </button>
            </a>
        </div>
    </div>
    <div class="  bg-white rounded p-4 shadow mb-5 ">
        <div class="row">
            <div class="col-sm-12 col-md-6 col-xl-3  form-floating mb-3 text-muted">
                <div class=" rounded-5">
                    <select class="form-select p-3" id="ReqStatus" aria-label="form-select-lg example" >
                        <option selected hidden value="0">Select Request Status</option>
                        <option value="1">New</option>
                        <option value="2">Pending</option>
                        <option value="3">Active</option>
                        <option value="4">Conclude</option>
                        <option value="5">To Close</option>
                        <option value="6">Unpaid</option>
                    </select>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-xl-3 form-floating mb-3 text-muted">
                <input name="PatientName" type="text" class="form-control" id="PatientName" placeholder="Patient Name">
                <label for="PatientName" class="form-label ms-2">Patient Name</label>
            </div>
            <div class="col-sm-12 col-md-6 col-xl-3  form-floating mb-3 text-muted">
                <div class=" rounded-5">
                    <select class="form-select p-3" id="ReqType" aria-label="form-select-lg example" >
                        <option selected hidden value="0">Select Request Type</option>
                        @foreach (var type in @Model.ReqType)
                        {
                            <option value="@type.Requesttypeid">@type.Name</option>
                        }
                    </select>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-xl-3 form-floating mb-3 text-muted">
                <input name="FromDateOfService" type="date" class="form-control" id="FromDateOfService" placeholder="FromDateOfService">
                <label for="FromDateOfService" class="form-label ms-2">From Date Of Service</label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-xl-3 form-floating mb-3 text-muted">
                <input name="ToDateOfService" type="date" class="form-control" id="ToDateOfService" placeholder="ToDateOfService">
                <label for="ToDateOfService" class="form-label ms-2">To Date Of Service</label>
            </div>
            <div class="col-sm-12 col-md-6 col-xl-3 form-floating mb-3 text-muted">
                <input name="ProviderName" type="text" class="form-control"  id="ProviderName" placeholder="ProviderName">
                <label for="ProviderName" class="form-label ms-2">Provider Name</label>
            </div>
            <div class="col-sm-12 col-md-6 col-xl-3 form-floating mb-3 text-muted">
                <input name="Email" type="text" class="form-control" id="Email" placeholder="Email">
                <label for="Email" class="form-label ms-2">Email</label>
            </div>
            <div class="col-sm-12 col-md-6 col-xl-3 form-floating mb-3 text-muted">
                <input name="PhoneNumber" type="text" class="form-control"  id="PhoneNumber" placeholder="PhoneNumber">
                <label for="PhoneNumber" class="form-label ms-2">Phone Number</label>
            </div>


        </div>
        <div class="row">
            <div class="col text-end">
                <button class="btn btn-outline-info me-2" onclick="document.location.reload(true)">Clear</button>
                <button class=" btn btn-info text-white" onclick="getRecords()">Search</button>
            </div>


        </div>
        <div class="row">
            <div id="tableContent"></div>
        </div>

        
    </div>


</div>

<script>
    $(document).ready(function () {

        // var profid = document.getElementById("SelectedProfessionId").value
        // var searchstr = document.getElementById("searchstr").value
        $.ajax({
            url: "/Admin/_SearchRecordsTable",
            // data: { profid: profid, searchstr: searchstr },
            type: "POST",
            success: function (result) {
                $("#tableContent").html(result)
            },
            error: function () {
                alert("An error occured!");

            }
        });
    });
    function getRecords(pagenumber) {

        if (pagenumber == 0) {
            pagenumber = @Model.CurrentPage;
        }
        var status = document.getElementById("ReqStatus").value
        var searchstr = document.getElementById("PatientName").value
        var reqtype = document.getElementById("ReqType").value
        var fdate = document.getElementById("FromDateOfService").value
        var tdate = document.getElementById("ToDateOfService").value
        var pname = document.getElementById("ProviderName").value
        var email = document.getElementById("Email").value
        var mobile = document.getElementById("PhoneNumber").value
        // var id = element.value;

        $.ajax({
            url: "/Admin/_SearchRecordsTable",
            data: { status: status, searchstr: searchstr, reqtype: reqtype, fdate: fdate, tdate: tdate, pname: pname, email: email, mobile: mobile, pagenumber: pagenumber },
            type: "POST",
            success: function (result) {
                $("#tableContent").html(result)
            },
            error: function () {
                alert("An error occured!");

            }
        });
    };
</script>


    <script>
    document.getElementById("records_dropdown").classList.add("active");
    </script>
