@model HalloDocWebEntity.ViewModel.Email_SMS_LogModel
@{
    Layout = "_AdminHeader";
}
<style>
    .form-floating > .form-select {
        padding-top: 0.625rem;
        padding-bottom: .625rem;
    }
</style>
<div class="m-3 ">
    <div class="row" style="--bs-gutter-x: 0rem;">
        <div class="col-12">
            <div class="container mt-5 ps-1">
                <h4 class="mt-3">Email Logs</h4>
            </div>
            <div class="container rounded bg-white shadow py-3 ">
                <div class=" w-100 px-3 row" style="--bs-gutter-x: 0rem;">
                    <div class="col-lg-2 col-md-4 col-sm-6 mt-1 pe-2">
                        <div class="form-floating">
                            <select class="form-select" id="RoleSelect">
                                <option value="0" selected>All Role</option>
                                <option value="1">Admin</option>
                                <option value="2">Patient</option>
                                <option value="3">Physician</option>
                            </select>
                        </div>
                    </div>

                    <div class="col-lg-2 col-md-4 col-sm-6 mt-1 pe-2">
                        <div class=" form-floating">
                            <input type="text" class="form-control me-2" id="name" placeholder="Receiver Name">
                            <label for="name" class="form-label">Receiver Name</label>
                        </div>
                    </div>

                    <div class="col-lg-2 col-md-4 col-sm-6 mt-1 pe-2">
                        <div class="form-floating">
                            <input type="text" class="form-control me-2" id="email" placeholder="Email Id">
                            <label for="email" class="form-label">Email Id</label>
                        </div>
                    </div>

                    <div class="col-lg-2 col-md-4 col-sm-6 mt-1 pe-2">
                        <div class="form-floating">
                            <input type="date" class="form-control me-2" id="createdDate">
                            <label for="createdDate" class="form-label">Created Date</label>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 mt-1 pe-2">
                        <div class="form-floating">
                            <input type="date" class="form-control me-2" id="sentDate">
                            <label for="sentDate" class="form-label">Sent Date</label>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 col-sm-6 mt-1 pe-2 text-end">
                        <button type="button" class="btn btn-info text-white p-2" onclick="getEmailLog()">Search</button>
                        <button type="button" class="btn border-info text-info p-2" onclick="document.location.reload(true)">Cancel</button>
                    </div>
                </div>

                <div id="tableContent" class="w-100">
                </div>

            </div>
        </div>


    </div>


</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    document.getElementById("records_dropdown").classList.add("active");
</script>
<script>
    $(document).ready(function () {
        $.ajax({
            url: "/Admin/EmailLogTable",
            type: "GET",
            data: { roleid: 0, name: null, email: null, createdDate: null, sentDate: null ,pagenumber: 1 },
            dataType: "html",
            success: function (data) {
                $("#tableContent").html(data);
            },
            error: function () {
                alert("No Projects Found");
                $("#tableContent").html('An error has occurred');
            }
        });
    });
</script>
<script>
    function getEmailLog(pagenumber) {

        if (pagenumber == 0) {
            pagenumber = @Model.CurrentPage;
        }
        let rid = document.getElementById('RoleSelect').value;
        let name = document.getElementById('name').value;
        let email = document.getElementById('email').value;
        let createdDateValue = document.getElementById('createdDate').value;
        let sentDateValue = document.getElementById('sentDate').value;
        let createdDate = createdDateValue ? new Date(createdDateValue).toISOString() : null;
        let sentDate = sentDateValue ? new Date(sentDateValue).toISOString() : null;
        $.ajax({
            url: "/Admin/EmailLogTable",
            type: "GET",
            data: { roleid: rid, name: name, email: email, createdDate: createdDate, sentDate: sentDate, pagenumber: pagenumber },
            dataType: "html",
            success: function (data) {
                $("#tableContent").html(data);

            },
            error: function () {
                alert("No Projects Found");
                $("#tableContent").html('An error has occurred');
            }
        });
    }
</script>