@model HalloDocWebEntity.ViewModel.ShiftDetailsModel
@{
    Layout = "_AdminHeader";
}
<style>
    .form-check-input:checked {
        background-color: #0dcaf0 !important;
        border-color: #0dcaf0 !important;
    }
</style>
<div class="container">
    <div class="row">
        <div class="col-12 mb-3">
            <div class="d-flex justify-content-between align-items-center my-3">
                <h4 class="mt-3 heading">Requested Shifts</h4>

                <a class="text-start text-info text-decoration-none " href="javascript:void(0);" onclick="history.go(-1);">
                    <button class="btn btn-white  text-info border-info rounded ">
                        <i class="fa-solid  fa-less-than"></i> Back
                    </button>
                </a>
            </div>
        </div>
    </div>

    <div class="border rounded shadow bg-white p-3">

        <div class="d-md-flex justify-content-between align-items-center mb-3">
            <form role="search" class="d-flex align-items-center border border-rounded rounded border-info bg-white mb-3">
                <i type="search" class="bi bi-search px-2"></i>
                <select asp-for=RegionId class="form-select border-0"  onchange="ShiftReview(this.value)" id="RegionDropdown">
                    <option  value="0">All Region</option>
                    @foreach(var i in Model.regions)
                    {
                        <option  value=@i.Regionid>@i.Name</option>
                    }

                </select>
            </form>
            <div class="justify-content-between">
                
                <button type="button" class="btn btn-success ms-1" id="approveBtn" onclick="ViewCurrentMonthShift()">
                    <span class="d-md-block d-none">View Current Month Shifts</span>
                    <span class="d-block d-md-none"><i class="bi bi-plus text-info fs-4"></i></span>
                </button>

                <button type="button" class="btn btn-success ms-1" id="approveBtn" onclick="approveShifts()">
                    <span class="d-md-block d-none">Approve Selected</span>
                    <span class="d-block d-md-none"><i class="bi bi-plus text-info fs-4"></i></span>
                </button>

                <button type="button" class="btn btn-danger ms-1" id="deleteBtn" onclick="deleteshifts()">
                    <span class="d-md-block d-none">Delete Selected</span>
                    <span class="d-block d-md-none"><i class="bi bi-plus text-info fs-4"></i></span>
                </button>
            </div>
        </div>

        <div id="tableContent">

        </div>
    </div>
</div>

<script>
  
    $(document).ready(function () {
        ShiftReview(0)
    });
    function selectAllCheckboxes() {
        var mainCheckbox = document.querySelector('#mainCheckbox'); // Replace with your actual main checkbox ID
        var checkboxes = document.querySelectorAll('.Subcheckbox'); // Replace with your checkbox class
        checkboxes.forEach(function (checkbox) {
            checkbox.checked = mainCheckbox.checked;
        });
    }
    function checkAllCheckboxes() {
        var count = document.getElementById("countcheckbox").value;
        console.log(count);
        var all = 0;
        for (var i = 0; i < count; i++) {
            if (document.getElementById("subchk_" + i).checked) {
                all++;
            } else {
                break;
            }
        }
        if (all == count) {
            document.getElementById("mainCheckbox").checked = true;
        }
        else {
            document.getElementById("mainCheckbox").checked = false;
        }
    }

    function approveShifts() {
        var checkboxes = document.querySelectorAll('.Subcheckbox:checked');
        var shifts = [];
        checkboxes.forEach(function (checkbox) {
            shifts.push(parseInt(checkbox.getAttribute('value')));
        });
        if (shifts.length > 0) {
            window.location.href = "/Admin/ApproveShift?selectedShifts=" + shifts;

        }
        else {
            Swal.fire('Please select atleast one shift to  approve.');
        }

    }



    function deleteshifts() {
        var checkboxes = document.querySelectorAll('.Subcheckbox:checked');
        var shifts = [];
        checkboxes.forEach(function (checkbox) {
            shifts.push(parseInt(checkbox.getAttribute('value')));
        });

        if (shifts.length > 0) {
            window.location.href = "/Admin/DeleteShift?selectedShifts=" + shifts;

        }
        else {
            alert('Please select atleast one shift to delete.');
        }

    }
    
    function ShiftReview(regionid) {
  
    
            $.ajax({
            url: "/Admin/_ShiftForReview",
            data: { 'reg': regionid ,'isCurrentMonth':false},
                type: "POST",
                dataType: "html",
                success: function (data) {
                $("#tableContent").html(data);
                },
                error: function () {
                    alert("No Projects Found");
                $("#tableContent").html('An error has occurred');
                }
            });
        

        //window.location.href = "/Admin/ShiftForReview?reg=" + regionid;
    }
      function ViewCurrentMonthShift() {
        var regionid = document.getElementById("RegionDropdown").value
    
            $.ajax({
            url: "/Admin/_ShiftForReview",
            data: { 'reg': regionid ,'isCurrentMonth':true},
                type: "POST",
                dataType: "html",
                success: function (data) {
                $("#tableContent").html(data);
                },
                error: function () {
                    alert("No Projects Found");
                $("#tableContent").html('An error has occurred');
                }
            });
        

        //window.location.href = "/Admin/ShiftForReview?reg=" + regionid;
    }

</script>
<script>
    document.getElementById("provider1").classList.add("active");
</script>
